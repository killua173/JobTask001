import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
import seaborn as sns

pd.set_option('display.max_columns', None)
pd.set_option('display.max_rows', None)

file_path = r'C:\Users\hamza\Downloads\archive (1)\global-data-on-sustainable-energy (1).csv'
data = pd.read_csv(file_path)

missing_percentage = data.isnull().sum() / len(data) * 100
print("Missing Percentage Before:")
print(missing_percentage)
print(data.dtypes)
data[r'Density\n(P/Km2)'] = pd.to_numeric(data[r'Density\n(P/Km2)'], errors='coerce')

columns_to_drop = missing_percentage[missing_percentage > 35].index
data = data.drop(columns=columns_to_drop)

for column in data.columns:
    if data[column].isnull().sum() > 0:
        if abs(data[column].skew()) > 0.5:
            data[column].fillna(data[column].median(), inplace=True)
        else:
            data[column].fillna(data[column].mean(), inplace=True)


print("\nDataset Head:")
print(data.head())

print("\nNull Values Sum:")
print(data.isnull().sum())
summary = data.describe()
print("Summary of numerical data:")
print(summary)


